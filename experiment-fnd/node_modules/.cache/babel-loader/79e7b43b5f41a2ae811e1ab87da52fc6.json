{"ast":null,"code":"/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * \n * @format\n */\n// flowlint ambiguous-object-type:error\n'use strict';\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _createForOfIteratorHelper2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createForOfIteratorHelper\"));\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\n\nvar _require = require('../multi-actor-environment/ActorUtils'),\n    ACTOR_IDENTIFIER_FIELD_NAME = _require.ACTOR_IDENTIFIER_FIELD_NAME,\n    getActorIdentifierFromPayload = _require.getActorIdentifierFromPayload;\n\nvar _require2 = require('../util/RelayConcreteNode'),\n    ACTOR_CHANGE = _require2.ACTOR_CHANGE,\n    CLIENT_COMPONENT = _require2.CLIENT_COMPONENT,\n    CLIENT_EXTENSION = _require2.CLIENT_EXTENSION,\n    CONDITION = _require2.CONDITION,\n    DEFER = _require2.DEFER,\n    FLIGHT_FIELD = _require2.FLIGHT_FIELD,\n    FRAGMENT_SPREAD = _require2.FRAGMENT_SPREAD,\n    INLINE_FRAGMENT = _require2.INLINE_FRAGMENT,\n    LINKED_FIELD = _require2.LINKED_FIELD,\n    LINKED_HANDLE = _require2.LINKED_HANDLE,\n    MODULE_IMPORT = _require2.MODULE_IMPORT,\n    SCALAR_FIELD = _require2.SCALAR_FIELD,\n    SCALAR_HANDLE = _require2.SCALAR_HANDLE,\n    STREAM = _require2.STREAM,\n    TYPE_DISCRIMINATOR = _require2.TYPE_DISCRIMINATOR;\n\nvar RelayFeatureFlags = require('../util/RelayFeatureFlags');\n\nvar _require3 = require('./ClientID'),\n    generateClientID = _require3.generateClientID,\n    isClientID = _require3.isClientID;\n\nvar _require4 = require('./RelayConcreteVariables'),\n    getLocalVariables = _require4.getLocalVariables;\n\nvar RelayModernRecord = require('./RelayModernRecord');\n\nvar _require5 = require('./RelayModernSelector'),\n    createNormalizationSelector = _require5.createNormalizationSelector;\n\nvar _require6 = require('./RelayStoreReactFlightUtils'),\n    REACT_FLIGHT_EXECUTABLE_DEFINITIONS_STORAGE_KEY = _require6.REACT_FLIGHT_EXECUTABLE_DEFINITIONS_STORAGE_KEY,\n    REACT_FLIGHT_TREE_STORAGE_KEY = _require6.REACT_FLIGHT_TREE_STORAGE_KEY,\n    REACT_FLIGHT_TYPE_NAME = _require6.REACT_FLIGHT_TYPE_NAME,\n    refineToReactFlightPayloadData = _require6.refineToReactFlightPayloadData;\n\nvar _require7 = require('./RelayStoreUtils'),\n    ROOT_ID = _require7.ROOT_ID,\n    ROOT_TYPE = _require7.ROOT_TYPE,\n    TYPENAME_KEY = _require7.TYPENAME_KEY,\n    getArgumentValues = _require7.getArgumentValues,\n    getHandleStorageKey = _require7.getHandleStorageKey,\n    getModuleComponentKey = _require7.getModuleComponentKey,\n    getModuleOperationKey = _require7.getModuleOperationKey,\n    getStorageKey = _require7.getStorageKey;\n\nvar _require8 = require('./TypeID'),\n    TYPE_SCHEMA_TYPE = _require8.TYPE_SCHEMA_TYPE,\n    generateTypeID = _require8.generateTypeID;\n\nvar areEqual = require(\"fbjs/lib/areEqual\");\n\nvar invariant = require('invariant');\n\nvar warning = require(\"fbjs/lib/warning\");\n/**\n * Normalizes the results of a query and standard GraphQL response, writing the\n * normalized records/fields into the given MutableRecordSource.\n */\n\n\nfunction normalize(recordSource, selector, response, options) {\n  var dataID = selector.dataID,\n      node = selector.node,\n      variables = selector.variables;\n  var normalizer = new RelayResponseNormalizer(recordSource, variables, options);\n  return normalizer.normalizeResponse(node, dataID, response);\n}\n/**\n * @private\n *\n * Helper for handling payloads.\n */\n\n\nvar RelayResponseNormalizer = /*#__PURE__*/function () {\n  function RelayResponseNormalizer(recordSource, variables, options) {\n    this._actorIdentifier = options.actorIdentifier;\n    this._getDataId = options.getDataID;\n    this._handleFieldPayloads = [];\n    this._treatMissingFieldsAsNull = options.treatMissingFieldsAsNull;\n    this._incrementalPlaceholders = [];\n    this._isClientExtension = false;\n    this._isUnmatchedAbstractType = false;\n    this._followupPayloads = [];\n    this._path = options.path ? (0, _toConsumableArray2[\"default\"])(options.path) : [];\n    this._recordSource = recordSource;\n    this._variables = variables;\n    this._reactFlightPayloadDeserializer = options.reactFlightPayloadDeserializer;\n    this._reactFlightServerErrorHandler = options.reactFlightServerErrorHandler;\n    this._shouldProcessClientComponents = options.shouldProcessClientComponents;\n  }\n\n  var _proto = RelayResponseNormalizer.prototype;\n\n  _proto.normalizeResponse = function normalizeResponse(node, dataID, data) {\n    var record = this._recordSource.get(dataID);\n\n    !record ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayResponseNormalizer(): Expected root record `%s` to exist.', dataID) : invariant(false) : void 0;\n\n    this._traverseSelections(node, record, data);\n\n    return {\n      errors: null,\n      fieldPayloads: this._handleFieldPayloads,\n      incrementalPlaceholders: this._incrementalPlaceholders,\n      followupPayloads: this._followupPayloads,\n      source: this._recordSource,\n      isFinal: false\n    };\n  };\n\n  _proto._getVariableValue = function _getVariableValue(name) {\n    !this._variables.hasOwnProperty(name) ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayResponseNormalizer(): Undefined variable `%s`.', name) : invariant(false) : void 0;\n    return this._variables[name];\n  };\n\n  _proto._getRecordType = function _getRecordType(data) {\n    var typeName = data[TYPENAME_KEY];\n    !(typeName != null) ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayResponseNormalizer(): Expected a typename for record `%s`.', JSON.stringify(data, null, 2)) : invariant(false) : void 0;\n    return typeName;\n  };\n\n  _proto._traverseSelections = function _traverseSelections(node, record, data) {\n    for (var i = 0; i < node.selections.length; i++) {\n      var selection = node.selections[i];\n\n      switch (selection.kind) {\n        case SCALAR_FIELD:\n        case LINKED_FIELD:\n          this._normalizeField(node, selection, record, data);\n\n          break;\n\n        case CONDITION:\n          var conditionValue = Boolean(this._getVariableValue(selection.condition));\n\n          if (conditionValue === selection.passingValue) {\n            this._traverseSelections(selection, record, data);\n          }\n\n          break;\n\n        case FRAGMENT_SPREAD:\n          {\n            var prevVariables = this._variables;\n            this._variables = getLocalVariables(this._variables, selection.fragment.argumentDefinitions, selection.args);\n\n            this._traverseSelections(selection.fragment, record, data);\n\n            this._variables = prevVariables;\n            break;\n          }\n\n        case INLINE_FRAGMENT:\n          {\n            var abstractKey = selection.abstractKey;\n\n            if (abstractKey == null) {\n              var _typeName = RelayModernRecord.getType(record);\n\n              if (_typeName === selection.type) {\n                this._traverseSelections(selection, record, data);\n              }\n            } else {\n              var implementsInterface = data.hasOwnProperty(abstractKey);\n\n              var _typeName2 = RelayModernRecord.getType(record);\n\n              var typeID = generateTypeID(_typeName2);\n\n              var typeRecord = this._recordSource.get(typeID);\n\n              if (typeRecord == null) {\n                typeRecord = RelayModernRecord.create(typeID, TYPE_SCHEMA_TYPE);\n\n                this._recordSource.set(typeID, typeRecord);\n              }\n\n              RelayModernRecord.setValue(typeRecord, abstractKey, implementsInterface);\n\n              if (implementsInterface) {\n                this._traverseSelections(selection, record, data);\n              }\n            }\n\n            break;\n          }\n\n        case TYPE_DISCRIMINATOR:\n          {\n            var _abstractKey = selection.abstractKey;\n\n            var _implementsInterface = data.hasOwnProperty(_abstractKey);\n\n            var _typeName3 = RelayModernRecord.getType(record);\n\n            var _typeID = generateTypeID(_typeName3);\n\n            var _typeRecord = this._recordSource.get(_typeID);\n\n            if (_typeRecord == null) {\n              _typeRecord = RelayModernRecord.create(_typeID, TYPE_SCHEMA_TYPE);\n\n              this._recordSource.set(_typeID, _typeRecord);\n            }\n\n            RelayModernRecord.setValue(_typeRecord, _abstractKey, _implementsInterface);\n            break;\n          }\n\n        case LINKED_HANDLE:\n        case SCALAR_HANDLE:\n          var args = selection.args ? getArgumentValues(selection.args, this._variables) : {};\n          var fieldKey = getStorageKey(selection, this._variables);\n          var handleKey = getHandleStorageKey(selection, this._variables);\n\n          this._handleFieldPayloads.push({\n            /* $FlowFixMe[class-object-subtyping] added when improving typing\n             * for this parameters */\n            args: args,\n            dataID: RelayModernRecord.getDataID(record),\n            fieldKey: fieldKey,\n            handle: selection.handle,\n            handleKey: handleKey,\n            handleArgs: selection.handleArgs ?\n            /* $FlowFixMe[class-object-subtyping] added when improving typing\n             * for this parameters */\n            getArgumentValues(selection.handleArgs, this._variables) : {}\n          });\n\n          break;\n\n        case MODULE_IMPORT:\n          this._normalizeModuleImport(node, selection, record, data);\n\n          break;\n\n        case DEFER:\n          this._normalizeDefer(selection, record, data);\n\n          break;\n\n        case STREAM:\n          this._normalizeStream(selection, record, data);\n\n          break;\n\n        case CLIENT_EXTENSION:\n          var isClientExtension = this._isClientExtension;\n          this._isClientExtension = true;\n\n          this._traverseSelections(selection, record, data);\n\n          this._isClientExtension = isClientExtension;\n          break;\n\n        case CLIENT_COMPONENT:\n          if (this._shouldProcessClientComponents === false) {\n            break;\n          }\n\n          this._traverseSelections(selection.fragment, record, data);\n\n          break;\n\n        case FLIGHT_FIELD:\n          if (RelayFeatureFlags.ENABLE_REACT_FLIGHT_COMPONENT_FIELD) {\n            this._normalizeFlightField(node, selection, record, data);\n          } else {\n            throw new Error('Flight fields are not yet supported.');\n          }\n\n          break;\n\n        case ACTOR_CHANGE:\n          this._normalizeActorChange(node, selection, record, data);\n\n          break;\n\n        default:\n          selection;\n          !false ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayResponseNormalizer(): Unexpected ast kind `%s`.', selection.kind) : invariant(false) : void 0;\n      }\n    }\n  };\n\n  _proto._normalizeDefer = function _normalizeDefer(defer, record, data) {\n    var isDeferred = defer[\"if\"] === null || this._getVariableValue(defer[\"if\"]);\n\n    if (process.env.NODE_ENV !== \"production\") {\n      process.env.NODE_ENV !== \"production\" ? warning(typeof isDeferred === 'boolean', 'RelayResponseNormalizer: Expected value for @defer `if` argument to ' + 'be a boolean, got `%s`.', isDeferred) : void 0;\n    }\n\n    if (isDeferred === false) {\n      // If defer is disabled there will be no additional response chunk:\n      // normalize the data already present.\n      this._traverseSelections(defer, record, data);\n    } else {\n      // Otherwise data *for this selection* should not be present: enqueue\n      // metadata to process the subsequent response chunk.\n      this._incrementalPlaceholders.push({\n        kind: 'defer',\n        data: data,\n        label: defer.label,\n        path: (0, _toConsumableArray2[\"default\"])(this._path),\n        selector: createNormalizationSelector(defer, RelayModernRecord.getDataID(record), this._variables),\n        typeName: RelayModernRecord.getType(record),\n        actorIdentifier: this._actorIdentifier\n      });\n    }\n  };\n\n  _proto._normalizeStream = function _normalizeStream(stream, record, data) {\n    // Always normalize regardless of whether streaming is enabled or not,\n    // this populates the initial array value (including any items when\n    // initial_count > 0).\n    this._traverseSelections(stream, record, data);\n\n    var isStreamed = stream[\"if\"] === null || this._getVariableValue(stream[\"if\"]);\n\n    if (process.env.NODE_ENV !== \"production\") {\n      process.env.NODE_ENV !== \"production\" ? warning(typeof isStreamed === 'boolean', 'RelayResponseNormalizer: Expected value for @stream `if` argument ' + 'to be a boolean, got `%s`.', isStreamed) : void 0;\n    }\n\n    if (isStreamed === true) {\n      // If streaming is enabled, *also* emit metadata to process any\n      // response chunks that may be delivered.\n      this._incrementalPlaceholders.push({\n        kind: 'stream',\n        label: stream.label,\n        path: (0, _toConsumableArray2[\"default\"])(this._path),\n        parentID: RelayModernRecord.getDataID(record),\n        node: stream,\n        variables: this._variables,\n        actorIdentifier: this._actorIdentifier\n      });\n    }\n  };\n\n  _proto._normalizeModuleImport = function _normalizeModuleImport(parent, moduleImport, record, data) {\n    !(typeof data === 'object' && data) ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayResponseNormalizer: Expected data for @module to be an object.') : invariant(false) : void 0;\n    var typeName = RelayModernRecord.getType(record);\n    var componentKey = getModuleComponentKey(moduleImport.documentName);\n    var componentReference = data[componentKey];\n    RelayModernRecord.setValue(record, componentKey, componentReference !== null && componentReference !== void 0 ? componentReference : null);\n    var operationKey = getModuleOperationKey(moduleImport.documentName);\n    var operationReference = data[operationKey];\n    RelayModernRecord.setValue(record, operationKey, operationReference !== null && operationReference !== void 0 ? operationReference : null);\n\n    if (operationReference != null) {\n      this._followupPayloads.push({\n        kind: 'ModuleImportPayload',\n        args: moduleImport.args,\n        data: data,\n        dataID: RelayModernRecord.getDataID(record),\n        operationReference: operationReference,\n        path: (0, _toConsumableArray2[\"default\"])(this._path),\n        typeName: typeName,\n        variables: this._variables,\n        actorIdentifier: this._actorIdentifier\n      });\n    }\n  };\n\n  _proto._normalizeField = function _normalizeField(parent, selection, record, data) {\n    !(typeof data === 'object' && data) ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'writeField(): Expected data for field `%s` to be an object.', selection.name) : invariant(false) : void 0;\n    var responseKey = selection.alias || selection.name;\n    var storageKey = getStorageKey(selection, this._variables);\n    var fieldValue = data[responseKey];\n\n    if (fieldValue == null) {\n      if (fieldValue === undefined) {\n        // Fields may be missing in the response in two main cases:\n        // - Inside a client extension: the server will not generally return\n        //   values for these fields, but a local update may provide them.\n        // - Inside an abstract type refinement where the concrete type does\n        //   not conform to the interface/union.\n        // However an otherwise-required field may also be missing if the server\n        // is configured to skip fields with `null` values, in which case the\n        // client is assumed to be correctly configured with\n        // treatMissingFieldsAsNull=true.\n        var isOptionalField = this._isClientExtension || this._isUnmatchedAbstractType;\n\n        if (isOptionalField) {\n          // Field not expected to exist regardless of whether the server is pruning null\n          // fields or not.\n          return;\n        } else if (!this._treatMissingFieldsAsNull) {\n          // Not optional and the server is not pruning null fields: field is expected\n          // to be present\n          if (process.env.NODE_ENV !== \"production\") {\n            process.env.NODE_ENV !== \"production\" ? warning(false, 'RelayResponseNormalizer: Payload did not contain a value ' + 'for field `%s: %s`. Check that you are parsing with the same ' + 'query that was used to fetch the payload.', responseKey, storageKey) : void 0;\n          }\n\n          return;\n        }\n      }\n\n      if (process.env.NODE_ENV !== \"production\") {\n        if (selection.kind === SCALAR_FIELD) {\n          this._validateConflictingFieldsWithIdenticalId(record, storageKey, // When using `treatMissingFieldsAsNull` the conflicting validation raises a false positive\n          // because the value is set using `null` but validated using `fieldValue` which at this point\n          // will be `undefined`.\n          // Setting this to `null` matches the value that we actually set to the `fieldValue`.\n          null);\n        }\n      }\n\n      RelayModernRecord.setValue(record, storageKey, null);\n      return;\n    }\n\n    if (selection.kind === SCALAR_FIELD) {\n      if (process.env.NODE_ENV !== \"production\") {\n        this._validateConflictingFieldsWithIdenticalId(record, storageKey, fieldValue);\n      }\n\n      RelayModernRecord.setValue(record, storageKey, fieldValue);\n    } else if (selection.kind === LINKED_FIELD) {\n      this._path.push(responseKey);\n\n      if (selection.plural) {\n        this._normalizePluralLink(selection, record, storageKey, fieldValue);\n      } else {\n        this._normalizeLink(selection, record, storageKey, fieldValue);\n      }\n\n      this._path.pop();\n    } else {\n      selection;\n      !false ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayResponseNormalizer(): Unexpected ast kind `%s` during normalization.', selection.kind) : invariant(false) : void 0;\n    }\n  };\n\n  _proto._normalizeActorChange = function _normalizeActorChange(parent, selection, record, data) {\n    var _field$concreteType;\n\n    var field = selection.linkedField;\n    !(typeof data === 'object' && data) ? process.env.NODE_ENV !== \"production\" ? invariant(false, '_normalizeActorChange(): Expected data for field `%s` to be an object.', field.name) : invariant(false) : void 0;\n    var responseKey = field.alias || field.name;\n    var storageKey = getStorageKey(field, this._variables);\n    var fieldValue = data[responseKey];\n\n    if (fieldValue == null) {\n      if (fieldValue === undefined) {\n        var isOptionalField = this._isClientExtension || this._isUnmatchedAbstractType;\n\n        if (isOptionalField) {\n          return;\n        } else if (!this._treatMissingFieldsAsNull) {\n          if (process.env.NODE_ENV !== \"production\") {\n            process.env.NODE_ENV !== \"production\" ? warning(false, 'RelayResponseNormalizer: Payload did not contain a value ' + 'for field `%s: %s`. Check that you are parsing with the same ' + 'query that was used to fetch the payload.', responseKey, storageKey) : void 0;\n          }\n\n          return;\n        }\n      }\n\n      RelayModernRecord.setValue(record, storageKey, null);\n      return;\n    }\n\n    var actorIdentifier = getActorIdentifierFromPayload(fieldValue);\n\n    if (actorIdentifier == null) {\n      if (process.env.NODE_ENV !== \"production\") {\n        process.env.NODE_ENV !== \"production\" ? warning(false, 'RelayResponseNormalizer: Payload did not contain a value ' + 'for field `%s`. Check that you are parsing with the same ' + 'query that was used to fetch the payload. Payload is `%s`.', ACTOR_IDENTIFIER_FIELD_NAME, JSON.stringify(fieldValue, null, 2)) : void 0;\n      }\n\n      RelayModernRecord.setValue(record, storageKey, null);\n      return;\n    } // $FlowFixMe[incompatible-call]\n\n\n    var typeName = (_field$concreteType = field.concreteType) !== null && _field$concreteType !== void 0 ? _field$concreteType : this._getRecordType(fieldValue);\n    var nextID = this._getDataId( // $FlowFixMe[incompatible-call]\n    fieldValue, typeName) || RelayModernRecord.getLinkedRecordID(record, storageKey) || generateClientID(RelayModernRecord.getDataID(record), storageKey);\n    !(typeof nextID === 'string') ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayResponseNormalizer: Expected id on field `%s` to be a string.', storageKey) : invariant(false) : void 0;\n    RelayModernRecord.setActorLinkedRecordID(record, storageKey, actorIdentifier, nextID);\n\n    this._followupPayloads.push({\n      kind: 'ActorPayload',\n      data: fieldValue,\n      dataID: nextID,\n      path: [].concat((0, _toConsumableArray2[\"default\"])(this._path), [responseKey]),\n      typeName: typeName,\n      variables: this._variables,\n      node: field,\n      actorIdentifier: actorIdentifier\n    });\n  };\n\n  _proto._normalizeFlightField = function _normalizeFlightField(parent, selection, record, data) {\n    var responseKey = selection.alias || selection.name;\n    var storageKey = getStorageKey(selection, this._variables);\n    var fieldValue = data[responseKey];\n\n    if (fieldValue == null) {\n      if (fieldValue === undefined) {\n        // Flight field may be missing in the response if:\n        // - It is inside an abstract type refinement where the concrete type does\n        //   not conform to the interface/union.\n        // However an otherwise-required field may also be missing if the server\n        // is configured to skip fields with `null` values, in which case the\n        // client is assumed to be correctly configured with\n        // treatMissingFieldsAsNull=true.\n        if (this._isUnmatchedAbstractType) {\n          // Field not expected to exist regardless of whether the server is pruning null\n          // fields or not.\n          return;\n        } else {\n          // Not optional and the server is not pruning null fields: field is expected\n          // to be present\n          !this._treatMissingFieldsAsNull ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayResponseNormalizer: Payload did not contain a value for ' + 'field `%s: %s`. Check that you are parsing with the same ' + 'query that was used to fetch the payload.', responseKey, storageKey) : invariant(false) : void 0;\n        }\n      }\n\n      RelayModernRecord.setValue(record, storageKey, null);\n      return;\n    }\n\n    var reactFlightPayload = refineToReactFlightPayloadData(fieldValue);\n    var reactFlightPayloadDeserializer = this._reactFlightPayloadDeserializer;\n    !(reactFlightPayload != null) ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayResponseNormalizer: Expected React Flight payload data to be an ' + 'object with `status`, tree`, `queries` and `errors` properties, got ' + '`%s`.', fieldValue) : invariant(false) : void 0;\n    !(typeof reactFlightPayloadDeserializer === 'function') ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayResponseNormalizer: Expected reactFlightPayloadDeserializer to ' + 'be a function, got `%s`.', reactFlightPayloadDeserializer) : invariant(false) : void 0;\n\n    if (reactFlightPayload.errors.length > 0) {\n      if (typeof this._reactFlightServerErrorHandler === 'function') {\n        this._reactFlightServerErrorHandler(reactFlightPayload.status, reactFlightPayload.errors);\n      } else {\n        process.env.NODE_ENV !== \"production\" ? warning(false, 'RelayResponseNormalizer: Received server errors for field `%s`.\\n\\n' + '%s\\n%s', responseKey, reactFlightPayload.errors[0].message, reactFlightPayload.errors[0].stack) : void 0;\n      }\n    }\n\n    var reactFlightID = generateClientID(RelayModernRecord.getDataID(record), getStorageKey(selection, this._variables));\n\n    var reactFlightClientResponseRecord = this._recordSource.get(reactFlightID);\n\n    if (reactFlightClientResponseRecord == null) {\n      reactFlightClientResponseRecord = RelayModernRecord.create(reactFlightID, REACT_FLIGHT_TYPE_NAME);\n\n      this._recordSource.set(reactFlightID, reactFlightClientResponseRecord);\n    }\n\n    if (reactFlightPayload.tree == null) {\n      // This typically indicates that a fatal server error prevented rows from\n      // being written. When this occurs, we should not continue normalization of\n      // the Flight field because the row response is malformed.\n      //\n      // Receiving empty rows is OK because it can indicate the start of a stream.\n      process.env.NODE_ENV !== \"production\" ? warning(false, 'RelayResponseNormalizer: Expected `tree` not to be null. This ' + 'typically indicates that a fatal server error prevented any Server ' + 'Component rows from being written.') : void 0; // We create the flight record with a null value for the tree\n      // and empty reachable definitions\n\n      RelayModernRecord.setValue(reactFlightClientResponseRecord, REACT_FLIGHT_TREE_STORAGE_KEY, null);\n      RelayModernRecord.setValue(reactFlightClientResponseRecord, REACT_FLIGHT_EXECUTABLE_DEFINITIONS_STORAGE_KEY, []);\n      RelayModernRecord.setLinkedRecordID(record, storageKey, reactFlightID);\n      return;\n    } // We store the deserialized reactFlightClientResponse in a separate\n    // record and link it to the parent record. This is so we can GC the Flight\n    // tree later even if the parent record is still reachable.\n\n\n    var reactFlightClientResponse = reactFlightPayloadDeserializer(reactFlightPayload.tree);\n    RelayModernRecord.setValue(reactFlightClientResponseRecord, REACT_FLIGHT_TREE_STORAGE_KEY, reactFlightClientResponse);\n    var reachableExecutableDefinitions = [];\n\n    var _iterator = (0, _createForOfIteratorHelper2[\"default\"])(reactFlightPayload.queries),\n        _step;\n\n    try {\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var query = _step.value;\n\n        if (query.response.data != null) {\n          this._followupPayloads.push({\n            kind: 'ModuleImportPayload',\n            args: null,\n            data: query.response.data,\n            dataID: ROOT_ID,\n            operationReference: query.module,\n            path: [],\n            typeName: ROOT_TYPE,\n            variables: query.variables,\n            actorIdentifier: this._actorIdentifier\n          });\n        }\n\n        reachableExecutableDefinitions.push({\n          module: query.module,\n          variables: query.variables\n        });\n      }\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n\n    var _iterator2 = (0, _createForOfIteratorHelper2[\"default\"])(reactFlightPayload.fragments),\n        _step2;\n\n    try {\n      for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n        var fragment = _step2.value;\n\n        if (fragment.response.data != null) {\n          this._followupPayloads.push({\n            kind: 'ModuleImportPayload',\n            args: null,\n            data: fragment.response.data,\n            dataID: fragment.__id,\n            operationReference: fragment.module,\n            path: [],\n            typeName: fragment.__typename,\n            variables: fragment.variables,\n            actorIdentifier: this._actorIdentifier\n          });\n        }\n\n        reachableExecutableDefinitions.push({\n          module: fragment.module,\n          variables: fragment.variables\n        });\n      }\n    } catch (err) {\n      _iterator2.e(err);\n    } finally {\n      _iterator2.f();\n    }\n\n    RelayModernRecord.setValue(reactFlightClientResponseRecord, REACT_FLIGHT_EXECUTABLE_DEFINITIONS_STORAGE_KEY, reachableExecutableDefinitions);\n    RelayModernRecord.setLinkedRecordID(record, storageKey, reactFlightID);\n  };\n\n  _proto._normalizeLink = function _normalizeLink(field, record, storageKey, fieldValue) {\n    var _field$concreteType2;\n\n    !(typeof fieldValue === 'object' && fieldValue) ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayResponseNormalizer: Expected data for field `%s` to be an object.', storageKey) : invariant(false) : void 0;\n    var nextID = this._getDataId( // $FlowFixMe[incompatible-variance]\n    fieldValue, // $FlowFixMe[incompatible-variance]\n    (_field$concreteType2 = field.concreteType) !== null && _field$concreteType2 !== void 0 ? _field$concreteType2 : this._getRecordType(fieldValue)) || // Reuse previously generated client IDs\n    RelayModernRecord.getLinkedRecordID(record, storageKey) || generateClientID(RelayModernRecord.getDataID(record), storageKey);\n    !(typeof nextID === 'string') ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayResponseNormalizer: Expected id on field `%s` to be a string.', storageKey) : invariant(false) : void 0;\n\n    if (process.env.NODE_ENV !== \"production\") {\n      this._validateConflictingLinkedFieldsWithIdenticalId(record, RelayModernRecord.getLinkedRecordID(record, storageKey), nextID, storageKey);\n    }\n\n    RelayModernRecord.setLinkedRecordID(record, storageKey, nextID);\n\n    var nextRecord = this._recordSource.get(nextID);\n\n    if (!nextRecord) {\n      // $FlowFixMe[incompatible-variance]\n      var _typeName4 = field.concreteType || this._getRecordType(fieldValue);\n\n      nextRecord = RelayModernRecord.create(nextID, _typeName4);\n\n      this._recordSource.set(nextID, nextRecord);\n    } else if (process.env.NODE_ENV !== \"production\") {\n      this._validateRecordType(nextRecord, field, fieldValue);\n    } // $FlowFixMe[incompatible-variance]\n\n\n    this._traverseSelections(field, nextRecord, fieldValue);\n  };\n\n  _proto._normalizePluralLink = function _normalizePluralLink(field, record, storageKey, fieldValue) {\n    var _this = this;\n\n    !Array.isArray(fieldValue) ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayResponseNormalizer: Expected data for field `%s` to be an array ' + 'of objects.', storageKey) : invariant(false) : void 0;\n    var prevIDs = RelayModernRecord.getLinkedRecordIDs(record, storageKey);\n    var nextIDs = [];\n    fieldValue.forEach(function (item, nextIndex) {\n      var _field$concreteType3; // validate response data\n\n\n      if (item == null) {\n        nextIDs.push(item);\n        return;\n      }\n\n      _this._path.push(String(nextIndex));\n\n      !(typeof item === 'object') ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayResponseNormalizer: Expected elements for field `%s` to be ' + 'objects.', storageKey) : invariant(false) : void 0;\n      var nextID = _this._getDataId( // $FlowFixMe[incompatible-variance]\n      item, // $FlowFixMe[incompatible-variance]\n      (_field$concreteType3 = field.concreteType) !== null && _field$concreteType3 !== void 0 ? _field$concreteType3 : _this._getRecordType(item)) || prevIDs && prevIDs[nextIndex] || // Reuse previously generated client IDs:\n      generateClientID(RelayModernRecord.getDataID(record), storageKey, nextIndex);\n      !(typeof nextID === 'string') ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayResponseNormalizer: Expected id of elements of field `%s` to ' + 'be strings.', storageKey) : invariant(false) : void 0;\n      nextIDs.push(nextID);\n\n      var nextRecord = _this._recordSource.get(nextID);\n\n      if (!nextRecord) {\n        // $FlowFixMe[incompatible-variance]\n        var _typeName5 = field.concreteType || _this._getRecordType(item);\n\n        nextRecord = RelayModernRecord.create(nextID, _typeName5);\n\n        _this._recordSource.set(nextID, nextRecord);\n      } else if (process.env.NODE_ENV !== \"production\") {\n        _this._validateRecordType(nextRecord, field, item);\n      } // NOTE: the check to strip __DEV__ code only works for simple\n      // `if (__DEV__)`\n\n\n      if (process.env.NODE_ENV !== \"production\") {\n        if (prevIDs) {\n          _this._validateConflictingLinkedFieldsWithIdenticalId(record, prevIDs[nextIndex], nextID, storageKey);\n        }\n      } // $FlowFixMe[incompatible-variance]\n\n\n      _this._traverseSelections(field, nextRecord, item);\n\n      _this._path.pop();\n    });\n    RelayModernRecord.setLinkedRecordIDs(record, storageKey, nextIDs);\n  }\n  /**\n   * Warns if the type of the record does not match the type of the field/payload.\n   */\n  ;\n\n  _proto._validateRecordType = function _validateRecordType(record, field, payload) {\n    var _field$concreteType4;\n\n    var typeName = (_field$concreteType4 = field.concreteType) !== null && _field$concreteType4 !== void 0 ? _field$concreteType4 : this._getRecordType(payload);\n    var dataID = RelayModernRecord.getDataID(record);\n    process.env.NODE_ENV !== \"production\" ? warning(isClientID(dataID) && dataID !== ROOT_ID || RelayModernRecord.getType(record) === typeName, 'RelayResponseNormalizer: Invalid record `%s`. Expected %s to be ' + 'consistent, but the record was assigned conflicting types `%s` ' + 'and `%s`. The GraphQL server likely violated the globally unique ' + 'id requirement by returning the same id for different objects.', dataID, TYPENAME_KEY, RelayModernRecord.getType(record), typeName) : void 0;\n  }\n  /**\n   * Warns if a single response contains conflicting fields with the same id\n   */\n  ;\n\n  _proto._validateConflictingFieldsWithIdenticalId = function _validateConflictingFieldsWithIdenticalId(record, storageKey, fieldValue) {\n    // NOTE: Only call this function in DEV\n    if (process.env.NODE_ENV !== \"production\") {\n      var dataID = RelayModernRecord.getDataID(record);\n      var previousValue = RelayModernRecord.getValue(record, storageKey);\n      process.env.NODE_ENV !== \"production\" ? warning(storageKey === TYPENAME_KEY || previousValue === undefined || areEqual(previousValue, fieldValue), 'RelayResponseNormalizer: Invalid record. The record contains two ' + 'instances of the same id: `%s` with conflicting field, %s and its values: %s and %s. ' + 'If two fields are different but share ' + 'the same id, one field will overwrite the other.', dataID, storageKey, previousValue, fieldValue) : void 0;\n    }\n  }\n  /**\n   * Warns if a single response contains conflicting fields with the same id\n   */\n  ;\n\n  _proto._validateConflictingLinkedFieldsWithIdenticalId = function _validateConflictingLinkedFieldsWithIdenticalId(record, prevID, nextID, storageKey) {\n    // NOTE: Only call this function in DEV\n    if (process.env.NODE_ENV !== \"production\") {\n      process.env.NODE_ENV !== \"production\" ? warning(prevID === undefined || prevID === nextID, 'RelayResponseNormalizer: Invalid record. The record contains ' + 'references to the conflicting field, %s and its id values: %s and %s. ' + 'We need to make sure that the record the field points ' + 'to remains consistent or one field will overwrite the other.', storageKey, prevID, nextID) : void 0;\n    }\n  };\n\n  return RelayResponseNormalizer;\n}();\n\nmodule.exports = {\n  normalize: normalize\n};","map":{"version":3,"names":["_interopRequireDefault","require","_createForOfIteratorHelper2","_toConsumableArray2","_require","ACTOR_IDENTIFIER_FIELD_NAME","getActorIdentifierFromPayload","_require2","ACTOR_CHANGE","CLIENT_COMPONENT","CLIENT_EXTENSION","CONDITION","DEFER","FLIGHT_FIELD","FRAGMENT_SPREAD","INLINE_FRAGMENT","LINKED_FIELD","LINKED_HANDLE","MODULE_IMPORT","SCALAR_FIELD","SCALAR_HANDLE","STREAM","TYPE_DISCRIMINATOR","RelayFeatureFlags","_require3","generateClientID","isClientID","_require4","getLocalVariables","RelayModernRecord","_require5","createNormalizationSelector","_require6","REACT_FLIGHT_EXECUTABLE_DEFINITIONS_STORAGE_KEY","REACT_FLIGHT_TREE_STORAGE_KEY","REACT_FLIGHT_TYPE_NAME","refineToReactFlightPayloadData","_require7","ROOT_ID","ROOT_TYPE","TYPENAME_KEY","getArgumentValues","getHandleStorageKey","getModuleComponentKey","getModuleOperationKey","getStorageKey","_require8","TYPE_SCHEMA_TYPE","generateTypeID","areEqual","invariant","warning","normalize","recordSource","selector","response","options","dataID","node","variables","normalizer","RelayResponseNormalizer","normalizeResponse","_actorIdentifier","actorIdentifier","_getDataId","getDataID","_handleFieldPayloads","_treatMissingFieldsAsNull","treatMissingFieldsAsNull","_incrementalPlaceholders","_isClientExtension","_isUnmatchedAbstractType","_followupPayloads","_path","path","_recordSource","_variables","_reactFlightPayloadDeserializer","reactFlightPayloadDeserializer","_reactFlightServerErrorHandler","reactFlightServerErrorHandler","_shouldProcessClientComponents","shouldProcessClientComponents","_proto","prototype","data","record","get","process","env","NODE_ENV","_traverseSelections","errors","fieldPayloads","incrementalPlaceholders","followupPayloads","source","isFinal","_getVariableValue","name","hasOwnProperty","_getRecordType","typeName","JSON","stringify","i","selections","length","selection","kind","_normalizeField","conditionValue","Boolean","condition","passingValue","prevVariables","fragment","argumentDefinitions","args","abstractKey","_typeName","getType","type","implementsInterface","_typeName2","typeID","typeRecord","create","set","setValue","_abstractKey","_implementsInterface","_typeName3","_typeID","_typeRecord","fieldKey","handleKey","push","handle","handleArgs","_normalizeModuleImport","_normalizeDefer","_normalizeStream","isClientExtension","ENABLE_REACT_FLIGHT_COMPONENT_FIELD","_normalizeFlightField","Error","_normalizeActorChange","defer","isDeferred","label","stream","isStreamed","parentID","parent","moduleImport","componentKey","documentName","componentReference","operationKey","operationReference","responseKey","alias","storageKey","fieldValue","undefined","isOptionalField","_validateConflictingFieldsWithIdenticalId","plural","_normalizePluralLink","_normalizeLink","pop","_field$concreteType","field","linkedField","concreteType","nextID","getLinkedRecordID","setActorLinkedRecordID","concat","reactFlightPayload","status","message","stack","reactFlightID","reactFlightClientResponseRecord","tree","setLinkedRecordID","reactFlightClientResponse","reachableExecutableDefinitions","_iterator","queries","_step","s","n","done","query","value","module","err","e","f","_iterator2","fragments","_step2","__id","__typename","_field$concreteType2","_validateConflictingLinkedFieldsWithIdenticalId","nextRecord","_typeName4","_validateRecordType","_this","Array","isArray","prevIDs","getLinkedRecordIDs","nextIDs","forEach","item","nextIndex","_field$concreteType3","String","_typeName5","setLinkedRecordIDs","payload","_field$concreteType4","previousValue","getValue","prevID","exports"],"sources":["/Users/anubhavgupta/Documents/react_learning/experiment_schema_ratings/rating-frontent-with-gql/module-rating-rough/experiment-fnd/node_modules/relay-runtime/lib/store/RelayResponseNormalizer.js"],"sourcesContent":["/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * \n * @format\n */\n// flowlint ambiguous-object-type:error\n'use strict';\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _createForOfIteratorHelper2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createForOfIteratorHelper\"));\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\n\nvar _require = require('../multi-actor-environment/ActorUtils'),\n    ACTOR_IDENTIFIER_FIELD_NAME = _require.ACTOR_IDENTIFIER_FIELD_NAME,\n    getActorIdentifierFromPayload = _require.getActorIdentifierFromPayload;\n\nvar _require2 = require('../util/RelayConcreteNode'),\n    ACTOR_CHANGE = _require2.ACTOR_CHANGE,\n    CLIENT_COMPONENT = _require2.CLIENT_COMPONENT,\n    CLIENT_EXTENSION = _require2.CLIENT_EXTENSION,\n    CONDITION = _require2.CONDITION,\n    DEFER = _require2.DEFER,\n    FLIGHT_FIELD = _require2.FLIGHT_FIELD,\n    FRAGMENT_SPREAD = _require2.FRAGMENT_SPREAD,\n    INLINE_FRAGMENT = _require2.INLINE_FRAGMENT,\n    LINKED_FIELD = _require2.LINKED_FIELD,\n    LINKED_HANDLE = _require2.LINKED_HANDLE,\n    MODULE_IMPORT = _require2.MODULE_IMPORT,\n    SCALAR_FIELD = _require2.SCALAR_FIELD,\n    SCALAR_HANDLE = _require2.SCALAR_HANDLE,\n    STREAM = _require2.STREAM,\n    TYPE_DISCRIMINATOR = _require2.TYPE_DISCRIMINATOR;\n\nvar RelayFeatureFlags = require('../util/RelayFeatureFlags');\n\nvar _require3 = require('./ClientID'),\n    generateClientID = _require3.generateClientID,\n    isClientID = _require3.isClientID;\n\nvar _require4 = require('./RelayConcreteVariables'),\n    getLocalVariables = _require4.getLocalVariables;\n\nvar RelayModernRecord = require('./RelayModernRecord');\n\nvar _require5 = require('./RelayModernSelector'),\n    createNormalizationSelector = _require5.createNormalizationSelector;\n\nvar _require6 = require('./RelayStoreReactFlightUtils'),\n    REACT_FLIGHT_EXECUTABLE_DEFINITIONS_STORAGE_KEY = _require6.REACT_FLIGHT_EXECUTABLE_DEFINITIONS_STORAGE_KEY,\n    REACT_FLIGHT_TREE_STORAGE_KEY = _require6.REACT_FLIGHT_TREE_STORAGE_KEY,\n    REACT_FLIGHT_TYPE_NAME = _require6.REACT_FLIGHT_TYPE_NAME,\n    refineToReactFlightPayloadData = _require6.refineToReactFlightPayloadData;\n\nvar _require7 = require('./RelayStoreUtils'),\n    ROOT_ID = _require7.ROOT_ID,\n    ROOT_TYPE = _require7.ROOT_TYPE,\n    TYPENAME_KEY = _require7.TYPENAME_KEY,\n    getArgumentValues = _require7.getArgumentValues,\n    getHandleStorageKey = _require7.getHandleStorageKey,\n    getModuleComponentKey = _require7.getModuleComponentKey,\n    getModuleOperationKey = _require7.getModuleOperationKey,\n    getStorageKey = _require7.getStorageKey;\n\nvar _require8 = require('./TypeID'),\n    TYPE_SCHEMA_TYPE = _require8.TYPE_SCHEMA_TYPE,\n    generateTypeID = _require8.generateTypeID;\n\nvar areEqual = require(\"fbjs/lib/areEqual\");\n\nvar invariant = require('invariant');\n\nvar warning = require(\"fbjs/lib/warning\");\n\n/**\n * Normalizes the results of a query and standard GraphQL response, writing the\n * normalized records/fields into the given MutableRecordSource.\n */\nfunction normalize(recordSource, selector, response, options) {\n  var dataID = selector.dataID,\n      node = selector.node,\n      variables = selector.variables;\n  var normalizer = new RelayResponseNormalizer(recordSource, variables, options);\n  return normalizer.normalizeResponse(node, dataID, response);\n}\n/**\n * @private\n *\n * Helper for handling payloads.\n */\n\n\nvar RelayResponseNormalizer = /*#__PURE__*/function () {\n  function RelayResponseNormalizer(recordSource, variables, options) {\n    this._actorIdentifier = options.actorIdentifier;\n    this._getDataId = options.getDataID;\n    this._handleFieldPayloads = [];\n    this._treatMissingFieldsAsNull = options.treatMissingFieldsAsNull;\n    this._incrementalPlaceholders = [];\n    this._isClientExtension = false;\n    this._isUnmatchedAbstractType = false;\n    this._followupPayloads = [];\n    this._path = options.path ? (0, _toConsumableArray2[\"default\"])(options.path) : [];\n    this._recordSource = recordSource;\n    this._variables = variables;\n    this._reactFlightPayloadDeserializer = options.reactFlightPayloadDeserializer;\n    this._reactFlightServerErrorHandler = options.reactFlightServerErrorHandler;\n    this._shouldProcessClientComponents = options.shouldProcessClientComponents;\n  }\n\n  var _proto = RelayResponseNormalizer.prototype;\n\n  _proto.normalizeResponse = function normalizeResponse(node, dataID, data) {\n    var record = this._recordSource.get(dataID);\n\n    !record ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayResponseNormalizer(): Expected root record `%s` to exist.', dataID) : invariant(false) : void 0;\n\n    this._traverseSelections(node, record, data);\n\n    return {\n      errors: null,\n      fieldPayloads: this._handleFieldPayloads,\n      incrementalPlaceholders: this._incrementalPlaceholders,\n      followupPayloads: this._followupPayloads,\n      source: this._recordSource,\n      isFinal: false\n    };\n  };\n\n  _proto._getVariableValue = function _getVariableValue(name) {\n    !this._variables.hasOwnProperty(name) ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayResponseNormalizer(): Undefined variable `%s`.', name) : invariant(false) : void 0;\n    return this._variables[name];\n  };\n\n  _proto._getRecordType = function _getRecordType(data) {\n    var typeName = data[TYPENAME_KEY];\n    !(typeName != null) ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayResponseNormalizer(): Expected a typename for record `%s`.', JSON.stringify(data, null, 2)) : invariant(false) : void 0;\n    return typeName;\n  };\n\n  _proto._traverseSelections = function _traverseSelections(node, record, data) {\n    for (var i = 0; i < node.selections.length; i++) {\n      var selection = node.selections[i];\n\n      switch (selection.kind) {\n        case SCALAR_FIELD:\n        case LINKED_FIELD:\n          this._normalizeField(node, selection, record, data);\n\n          break;\n\n        case CONDITION:\n          var conditionValue = Boolean(this._getVariableValue(selection.condition));\n\n          if (conditionValue === selection.passingValue) {\n            this._traverseSelections(selection, record, data);\n          }\n\n          break;\n\n        case FRAGMENT_SPREAD:\n          {\n            var prevVariables = this._variables;\n            this._variables = getLocalVariables(this._variables, selection.fragment.argumentDefinitions, selection.args);\n\n            this._traverseSelections(selection.fragment, record, data);\n\n            this._variables = prevVariables;\n            break;\n          }\n\n        case INLINE_FRAGMENT:\n          {\n            var abstractKey = selection.abstractKey;\n\n            if (abstractKey == null) {\n              var _typeName = RelayModernRecord.getType(record);\n\n              if (_typeName === selection.type) {\n                this._traverseSelections(selection, record, data);\n              }\n            } else {\n              var implementsInterface = data.hasOwnProperty(abstractKey);\n\n              var _typeName2 = RelayModernRecord.getType(record);\n\n              var typeID = generateTypeID(_typeName2);\n\n              var typeRecord = this._recordSource.get(typeID);\n\n              if (typeRecord == null) {\n                typeRecord = RelayModernRecord.create(typeID, TYPE_SCHEMA_TYPE);\n\n                this._recordSource.set(typeID, typeRecord);\n              }\n\n              RelayModernRecord.setValue(typeRecord, abstractKey, implementsInterface);\n\n              if (implementsInterface) {\n                this._traverseSelections(selection, record, data);\n              }\n            }\n\n            break;\n          }\n\n        case TYPE_DISCRIMINATOR:\n          {\n            var _abstractKey = selection.abstractKey;\n\n            var _implementsInterface = data.hasOwnProperty(_abstractKey);\n\n            var _typeName3 = RelayModernRecord.getType(record);\n\n            var _typeID = generateTypeID(_typeName3);\n\n            var _typeRecord = this._recordSource.get(_typeID);\n\n            if (_typeRecord == null) {\n              _typeRecord = RelayModernRecord.create(_typeID, TYPE_SCHEMA_TYPE);\n\n              this._recordSource.set(_typeID, _typeRecord);\n            }\n\n            RelayModernRecord.setValue(_typeRecord, _abstractKey, _implementsInterface);\n            break;\n          }\n\n        case LINKED_HANDLE:\n        case SCALAR_HANDLE:\n          var args = selection.args ? getArgumentValues(selection.args, this._variables) : {};\n          var fieldKey = getStorageKey(selection, this._variables);\n          var handleKey = getHandleStorageKey(selection, this._variables);\n\n          this._handleFieldPayloads.push({\n            /* $FlowFixMe[class-object-subtyping] added when improving typing\n             * for this parameters */\n            args: args,\n            dataID: RelayModernRecord.getDataID(record),\n            fieldKey: fieldKey,\n            handle: selection.handle,\n            handleKey: handleKey,\n            handleArgs: selection.handleArgs ?\n            /* $FlowFixMe[class-object-subtyping] added when improving typing\n             * for this parameters */\n            getArgumentValues(selection.handleArgs, this._variables) : {}\n          });\n\n          break;\n\n        case MODULE_IMPORT:\n          this._normalizeModuleImport(node, selection, record, data);\n\n          break;\n\n        case DEFER:\n          this._normalizeDefer(selection, record, data);\n\n          break;\n\n        case STREAM:\n          this._normalizeStream(selection, record, data);\n\n          break;\n\n        case CLIENT_EXTENSION:\n          var isClientExtension = this._isClientExtension;\n          this._isClientExtension = true;\n\n          this._traverseSelections(selection, record, data);\n\n          this._isClientExtension = isClientExtension;\n          break;\n\n        case CLIENT_COMPONENT:\n          if (this._shouldProcessClientComponents === false) {\n            break;\n          }\n\n          this._traverseSelections(selection.fragment, record, data);\n\n          break;\n\n        case FLIGHT_FIELD:\n          if (RelayFeatureFlags.ENABLE_REACT_FLIGHT_COMPONENT_FIELD) {\n            this._normalizeFlightField(node, selection, record, data);\n          } else {\n            throw new Error('Flight fields are not yet supported.');\n          }\n\n          break;\n\n        case ACTOR_CHANGE:\n          this._normalizeActorChange(node, selection, record, data);\n\n          break;\n\n        default:\n          selection;\n          !false ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayResponseNormalizer(): Unexpected ast kind `%s`.', selection.kind) : invariant(false) : void 0;\n      }\n    }\n  };\n\n  _proto._normalizeDefer = function _normalizeDefer(defer, record, data) {\n    var isDeferred = defer[\"if\"] === null || this._getVariableValue(defer[\"if\"]);\n\n    if (process.env.NODE_ENV !== \"production\") {\n      process.env.NODE_ENV !== \"production\" ? warning(typeof isDeferred === 'boolean', 'RelayResponseNormalizer: Expected value for @defer `if` argument to ' + 'be a boolean, got `%s`.', isDeferred) : void 0;\n    }\n\n    if (isDeferred === false) {\n      // If defer is disabled there will be no additional response chunk:\n      // normalize the data already present.\n      this._traverseSelections(defer, record, data);\n    } else {\n      // Otherwise data *for this selection* should not be present: enqueue\n      // metadata to process the subsequent response chunk.\n      this._incrementalPlaceholders.push({\n        kind: 'defer',\n        data: data,\n        label: defer.label,\n        path: (0, _toConsumableArray2[\"default\"])(this._path),\n        selector: createNormalizationSelector(defer, RelayModernRecord.getDataID(record), this._variables),\n        typeName: RelayModernRecord.getType(record),\n        actorIdentifier: this._actorIdentifier\n      });\n    }\n  };\n\n  _proto._normalizeStream = function _normalizeStream(stream, record, data) {\n    // Always normalize regardless of whether streaming is enabled or not,\n    // this populates the initial array value (including any items when\n    // initial_count > 0).\n    this._traverseSelections(stream, record, data);\n\n    var isStreamed = stream[\"if\"] === null || this._getVariableValue(stream[\"if\"]);\n\n    if (process.env.NODE_ENV !== \"production\") {\n      process.env.NODE_ENV !== \"production\" ? warning(typeof isStreamed === 'boolean', 'RelayResponseNormalizer: Expected value for @stream `if` argument ' + 'to be a boolean, got `%s`.', isStreamed) : void 0;\n    }\n\n    if (isStreamed === true) {\n      // If streaming is enabled, *also* emit metadata to process any\n      // response chunks that may be delivered.\n      this._incrementalPlaceholders.push({\n        kind: 'stream',\n        label: stream.label,\n        path: (0, _toConsumableArray2[\"default\"])(this._path),\n        parentID: RelayModernRecord.getDataID(record),\n        node: stream,\n        variables: this._variables,\n        actorIdentifier: this._actorIdentifier\n      });\n    }\n  };\n\n  _proto._normalizeModuleImport = function _normalizeModuleImport(parent, moduleImport, record, data) {\n    !(typeof data === 'object' && data) ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayResponseNormalizer: Expected data for @module to be an object.') : invariant(false) : void 0;\n    var typeName = RelayModernRecord.getType(record);\n    var componentKey = getModuleComponentKey(moduleImport.documentName);\n    var componentReference = data[componentKey];\n    RelayModernRecord.setValue(record, componentKey, componentReference !== null && componentReference !== void 0 ? componentReference : null);\n    var operationKey = getModuleOperationKey(moduleImport.documentName);\n    var operationReference = data[operationKey];\n    RelayModernRecord.setValue(record, operationKey, operationReference !== null && operationReference !== void 0 ? operationReference : null);\n\n    if (operationReference != null) {\n      this._followupPayloads.push({\n        kind: 'ModuleImportPayload',\n        args: moduleImport.args,\n        data: data,\n        dataID: RelayModernRecord.getDataID(record),\n        operationReference: operationReference,\n        path: (0, _toConsumableArray2[\"default\"])(this._path),\n        typeName: typeName,\n        variables: this._variables,\n        actorIdentifier: this._actorIdentifier\n      });\n    }\n  };\n\n  _proto._normalizeField = function _normalizeField(parent, selection, record, data) {\n    !(typeof data === 'object' && data) ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'writeField(): Expected data for field `%s` to be an object.', selection.name) : invariant(false) : void 0;\n    var responseKey = selection.alias || selection.name;\n    var storageKey = getStorageKey(selection, this._variables);\n    var fieldValue = data[responseKey];\n\n    if (fieldValue == null) {\n      if (fieldValue === undefined) {\n        // Fields may be missing in the response in two main cases:\n        // - Inside a client extension: the server will not generally return\n        //   values for these fields, but a local update may provide them.\n        // - Inside an abstract type refinement where the concrete type does\n        //   not conform to the interface/union.\n        // However an otherwise-required field may also be missing if the server\n        // is configured to skip fields with `null` values, in which case the\n        // client is assumed to be correctly configured with\n        // treatMissingFieldsAsNull=true.\n        var isOptionalField = this._isClientExtension || this._isUnmatchedAbstractType;\n\n        if (isOptionalField) {\n          // Field not expected to exist regardless of whether the server is pruning null\n          // fields or not.\n          return;\n        } else if (!this._treatMissingFieldsAsNull) {\n          // Not optional and the server is not pruning null fields: field is expected\n          // to be present\n          if (process.env.NODE_ENV !== \"production\") {\n            process.env.NODE_ENV !== \"production\" ? warning(false, 'RelayResponseNormalizer: Payload did not contain a value ' + 'for field `%s: %s`. Check that you are parsing with the same ' + 'query that was used to fetch the payload.', responseKey, storageKey) : void 0;\n          }\n\n          return;\n        }\n      }\n\n      if (process.env.NODE_ENV !== \"production\") {\n        if (selection.kind === SCALAR_FIELD) {\n          this._validateConflictingFieldsWithIdenticalId(record, storageKey, // When using `treatMissingFieldsAsNull` the conflicting validation raises a false positive\n          // because the value is set using `null` but validated using `fieldValue` which at this point\n          // will be `undefined`.\n          // Setting this to `null` matches the value that we actually set to the `fieldValue`.\n          null);\n        }\n      }\n\n      RelayModernRecord.setValue(record, storageKey, null);\n      return;\n    }\n\n    if (selection.kind === SCALAR_FIELD) {\n      if (process.env.NODE_ENV !== \"production\") {\n        this._validateConflictingFieldsWithIdenticalId(record, storageKey, fieldValue);\n      }\n\n      RelayModernRecord.setValue(record, storageKey, fieldValue);\n    } else if (selection.kind === LINKED_FIELD) {\n      this._path.push(responseKey);\n\n      if (selection.plural) {\n        this._normalizePluralLink(selection, record, storageKey, fieldValue);\n      } else {\n        this._normalizeLink(selection, record, storageKey, fieldValue);\n      }\n\n      this._path.pop();\n    } else {\n      selection;\n      !false ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayResponseNormalizer(): Unexpected ast kind `%s` during normalization.', selection.kind) : invariant(false) : void 0;\n    }\n  };\n\n  _proto._normalizeActorChange = function _normalizeActorChange(parent, selection, record, data) {\n    var _field$concreteType;\n\n    var field = selection.linkedField;\n    !(typeof data === 'object' && data) ? process.env.NODE_ENV !== \"production\" ? invariant(false, '_normalizeActorChange(): Expected data for field `%s` to be an object.', field.name) : invariant(false) : void 0;\n    var responseKey = field.alias || field.name;\n    var storageKey = getStorageKey(field, this._variables);\n    var fieldValue = data[responseKey];\n\n    if (fieldValue == null) {\n      if (fieldValue === undefined) {\n        var isOptionalField = this._isClientExtension || this._isUnmatchedAbstractType;\n\n        if (isOptionalField) {\n          return;\n        } else if (!this._treatMissingFieldsAsNull) {\n          if (process.env.NODE_ENV !== \"production\") {\n            process.env.NODE_ENV !== \"production\" ? warning(false, 'RelayResponseNormalizer: Payload did not contain a value ' + 'for field `%s: %s`. Check that you are parsing with the same ' + 'query that was used to fetch the payload.', responseKey, storageKey) : void 0;\n          }\n\n          return;\n        }\n      }\n\n      RelayModernRecord.setValue(record, storageKey, null);\n      return;\n    }\n\n    var actorIdentifier = getActorIdentifierFromPayload(fieldValue);\n\n    if (actorIdentifier == null) {\n      if (process.env.NODE_ENV !== \"production\") {\n        process.env.NODE_ENV !== \"production\" ? warning(false, 'RelayResponseNormalizer: Payload did not contain a value ' + 'for field `%s`. Check that you are parsing with the same ' + 'query that was used to fetch the payload. Payload is `%s`.', ACTOR_IDENTIFIER_FIELD_NAME, JSON.stringify(fieldValue, null, 2)) : void 0;\n      }\n\n      RelayModernRecord.setValue(record, storageKey, null);\n      return;\n    } // $FlowFixMe[incompatible-call]\n\n\n    var typeName = (_field$concreteType = field.concreteType) !== null && _field$concreteType !== void 0 ? _field$concreteType : this._getRecordType(fieldValue);\n    var nextID = this._getDataId( // $FlowFixMe[incompatible-call]\n    fieldValue, typeName) || RelayModernRecord.getLinkedRecordID(record, storageKey) || generateClientID(RelayModernRecord.getDataID(record), storageKey);\n    !(typeof nextID === 'string') ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayResponseNormalizer: Expected id on field `%s` to be a string.', storageKey) : invariant(false) : void 0;\n    RelayModernRecord.setActorLinkedRecordID(record, storageKey, actorIdentifier, nextID);\n\n    this._followupPayloads.push({\n      kind: 'ActorPayload',\n      data: fieldValue,\n      dataID: nextID,\n      path: [].concat((0, _toConsumableArray2[\"default\"])(this._path), [responseKey]),\n      typeName: typeName,\n      variables: this._variables,\n      node: field,\n      actorIdentifier: actorIdentifier\n    });\n  };\n\n  _proto._normalizeFlightField = function _normalizeFlightField(parent, selection, record, data) {\n    var responseKey = selection.alias || selection.name;\n    var storageKey = getStorageKey(selection, this._variables);\n    var fieldValue = data[responseKey];\n\n    if (fieldValue == null) {\n      if (fieldValue === undefined) {\n        // Flight field may be missing in the response if:\n        // - It is inside an abstract type refinement where the concrete type does\n        //   not conform to the interface/union.\n        // However an otherwise-required field may also be missing if the server\n        // is configured to skip fields with `null` values, in which case the\n        // client is assumed to be correctly configured with\n        // treatMissingFieldsAsNull=true.\n        if (this._isUnmatchedAbstractType) {\n          // Field not expected to exist regardless of whether the server is pruning null\n          // fields or not.\n          return;\n        } else {\n          // Not optional and the server is not pruning null fields: field is expected\n          // to be present\n          !this._treatMissingFieldsAsNull ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayResponseNormalizer: Payload did not contain a value for ' + 'field `%s: %s`. Check that you are parsing with the same ' + 'query that was used to fetch the payload.', responseKey, storageKey) : invariant(false) : void 0;\n        }\n      }\n\n      RelayModernRecord.setValue(record, storageKey, null);\n      return;\n    }\n\n    var reactFlightPayload = refineToReactFlightPayloadData(fieldValue);\n    var reactFlightPayloadDeserializer = this._reactFlightPayloadDeserializer;\n    !(reactFlightPayload != null) ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayResponseNormalizer: Expected React Flight payload data to be an ' + 'object with `status`, tree`, `queries` and `errors` properties, got ' + '`%s`.', fieldValue) : invariant(false) : void 0;\n    !(typeof reactFlightPayloadDeserializer === 'function') ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayResponseNormalizer: Expected reactFlightPayloadDeserializer to ' + 'be a function, got `%s`.', reactFlightPayloadDeserializer) : invariant(false) : void 0;\n\n    if (reactFlightPayload.errors.length > 0) {\n      if (typeof this._reactFlightServerErrorHandler === 'function') {\n        this._reactFlightServerErrorHandler(reactFlightPayload.status, reactFlightPayload.errors);\n      } else {\n        process.env.NODE_ENV !== \"production\" ? warning(false, 'RelayResponseNormalizer: Received server errors for field `%s`.\\n\\n' + '%s\\n%s', responseKey, reactFlightPayload.errors[0].message, reactFlightPayload.errors[0].stack) : void 0;\n      }\n    }\n\n    var reactFlightID = generateClientID(RelayModernRecord.getDataID(record), getStorageKey(selection, this._variables));\n\n    var reactFlightClientResponseRecord = this._recordSource.get(reactFlightID);\n\n    if (reactFlightClientResponseRecord == null) {\n      reactFlightClientResponseRecord = RelayModernRecord.create(reactFlightID, REACT_FLIGHT_TYPE_NAME);\n\n      this._recordSource.set(reactFlightID, reactFlightClientResponseRecord);\n    }\n\n    if (reactFlightPayload.tree == null) {\n      // This typically indicates that a fatal server error prevented rows from\n      // being written. When this occurs, we should not continue normalization of\n      // the Flight field because the row response is malformed.\n      //\n      // Receiving empty rows is OK because it can indicate the start of a stream.\n      process.env.NODE_ENV !== \"production\" ? warning(false, 'RelayResponseNormalizer: Expected `tree` not to be null. This ' + 'typically indicates that a fatal server error prevented any Server ' + 'Component rows from being written.') : void 0; // We create the flight record with a null value for the tree\n      // and empty reachable definitions\n\n      RelayModernRecord.setValue(reactFlightClientResponseRecord, REACT_FLIGHT_TREE_STORAGE_KEY, null);\n      RelayModernRecord.setValue(reactFlightClientResponseRecord, REACT_FLIGHT_EXECUTABLE_DEFINITIONS_STORAGE_KEY, []);\n      RelayModernRecord.setLinkedRecordID(record, storageKey, reactFlightID);\n      return;\n    } // We store the deserialized reactFlightClientResponse in a separate\n    // record and link it to the parent record. This is so we can GC the Flight\n    // tree later even if the parent record is still reachable.\n\n\n    var reactFlightClientResponse = reactFlightPayloadDeserializer(reactFlightPayload.tree);\n    RelayModernRecord.setValue(reactFlightClientResponseRecord, REACT_FLIGHT_TREE_STORAGE_KEY, reactFlightClientResponse);\n    var reachableExecutableDefinitions = [];\n\n    var _iterator = (0, _createForOfIteratorHelper2[\"default\"])(reactFlightPayload.queries),\n        _step;\n\n    try {\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var query = _step.value;\n\n        if (query.response.data != null) {\n          this._followupPayloads.push({\n            kind: 'ModuleImportPayload',\n            args: null,\n            data: query.response.data,\n            dataID: ROOT_ID,\n            operationReference: query.module,\n            path: [],\n            typeName: ROOT_TYPE,\n            variables: query.variables,\n            actorIdentifier: this._actorIdentifier\n          });\n        }\n\n        reachableExecutableDefinitions.push({\n          module: query.module,\n          variables: query.variables\n        });\n      }\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n\n    var _iterator2 = (0, _createForOfIteratorHelper2[\"default\"])(reactFlightPayload.fragments),\n        _step2;\n\n    try {\n      for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n        var fragment = _step2.value;\n\n        if (fragment.response.data != null) {\n          this._followupPayloads.push({\n            kind: 'ModuleImportPayload',\n            args: null,\n            data: fragment.response.data,\n            dataID: fragment.__id,\n            operationReference: fragment.module,\n            path: [],\n            typeName: fragment.__typename,\n            variables: fragment.variables,\n            actorIdentifier: this._actorIdentifier\n          });\n        }\n\n        reachableExecutableDefinitions.push({\n          module: fragment.module,\n          variables: fragment.variables\n        });\n      }\n    } catch (err) {\n      _iterator2.e(err);\n    } finally {\n      _iterator2.f();\n    }\n\n    RelayModernRecord.setValue(reactFlightClientResponseRecord, REACT_FLIGHT_EXECUTABLE_DEFINITIONS_STORAGE_KEY, reachableExecutableDefinitions);\n    RelayModernRecord.setLinkedRecordID(record, storageKey, reactFlightID);\n  };\n\n  _proto._normalizeLink = function _normalizeLink(field, record, storageKey, fieldValue) {\n    var _field$concreteType2;\n\n    !(typeof fieldValue === 'object' && fieldValue) ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayResponseNormalizer: Expected data for field `%s` to be an object.', storageKey) : invariant(false) : void 0;\n    var nextID = this._getDataId( // $FlowFixMe[incompatible-variance]\n    fieldValue, // $FlowFixMe[incompatible-variance]\n    (_field$concreteType2 = field.concreteType) !== null && _field$concreteType2 !== void 0 ? _field$concreteType2 : this._getRecordType(fieldValue)) || // Reuse previously generated client IDs\n    RelayModernRecord.getLinkedRecordID(record, storageKey) || generateClientID(RelayModernRecord.getDataID(record), storageKey);\n    !(typeof nextID === 'string') ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayResponseNormalizer: Expected id on field `%s` to be a string.', storageKey) : invariant(false) : void 0;\n\n    if (process.env.NODE_ENV !== \"production\") {\n      this._validateConflictingLinkedFieldsWithIdenticalId(record, RelayModernRecord.getLinkedRecordID(record, storageKey), nextID, storageKey);\n    }\n\n    RelayModernRecord.setLinkedRecordID(record, storageKey, nextID);\n\n    var nextRecord = this._recordSource.get(nextID);\n\n    if (!nextRecord) {\n      // $FlowFixMe[incompatible-variance]\n      var _typeName4 = field.concreteType || this._getRecordType(fieldValue);\n\n      nextRecord = RelayModernRecord.create(nextID, _typeName4);\n\n      this._recordSource.set(nextID, nextRecord);\n    } else if (process.env.NODE_ENV !== \"production\") {\n      this._validateRecordType(nextRecord, field, fieldValue);\n    } // $FlowFixMe[incompatible-variance]\n\n\n    this._traverseSelections(field, nextRecord, fieldValue);\n  };\n\n  _proto._normalizePluralLink = function _normalizePluralLink(field, record, storageKey, fieldValue) {\n    var _this = this;\n\n    !Array.isArray(fieldValue) ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayResponseNormalizer: Expected data for field `%s` to be an array ' + 'of objects.', storageKey) : invariant(false) : void 0;\n    var prevIDs = RelayModernRecord.getLinkedRecordIDs(record, storageKey);\n    var nextIDs = [];\n    fieldValue.forEach(function (item, nextIndex) {\n      var _field$concreteType3;\n\n      // validate response data\n      if (item == null) {\n        nextIDs.push(item);\n        return;\n      }\n\n      _this._path.push(String(nextIndex));\n\n      !(typeof item === 'object') ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayResponseNormalizer: Expected elements for field `%s` to be ' + 'objects.', storageKey) : invariant(false) : void 0;\n      var nextID = _this._getDataId( // $FlowFixMe[incompatible-variance]\n      item, // $FlowFixMe[incompatible-variance]\n      (_field$concreteType3 = field.concreteType) !== null && _field$concreteType3 !== void 0 ? _field$concreteType3 : _this._getRecordType(item)) || prevIDs && prevIDs[nextIndex] || // Reuse previously generated client IDs:\n      generateClientID(RelayModernRecord.getDataID(record), storageKey, nextIndex);\n      !(typeof nextID === 'string') ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayResponseNormalizer: Expected id of elements of field `%s` to ' + 'be strings.', storageKey) : invariant(false) : void 0;\n      nextIDs.push(nextID);\n\n      var nextRecord = _this._recordSource.get(nextID);\n\n      if (!nextRecord) {\n        // $FlowFixMe[incompatible-variance]\n        var _typeName5 = field.concreteType || _this._getRecordType(item);\n\n        nextRecord = RelayModernRecord.create(nextID, _typeName5);\n\n        _this._recordSource.set(nextID, nextRecord);\n      } else if (process.env.NODE_ENV !== \"production\") {\n        _this._validateRecordType(nextRecord, field, item);\n      } // NOTE: the check to strip __DEV__ code only works for simple\n      // `if (__DEV__)`\n\n\n      if (process.env.NODE_ENV !== \"production\") {\n        if (prevIDs) {\n          _this._validateConflictingLinkedFieldsWithIdenticalId(record, prevIDs[nextIndex], nextID, storageKey);\n        }\n      } // $FlowFixMe[incompatible-variance]\n\n\n      _this._traverseSelections(field, nextRecord, item);\n\n      _this._path.pop();\n    });\n    RelayModernRecord.setLinkedRecordIDs(record, storageKey, nextIDs);\n  }\n  /**\n   * Warns if the type of the record does not match the type of the field/payload.\n   */\n  ;\n\n  _proto._validateRecordType = function _validateRecordType(record, field, payload) {\n    var _field$concreteType4;\n\n    var typeName = (_field$concreteType4 = field.concreteType) !== null && _field$concreteType4 !== void 0 ? _field$concreteType4 : this._getRecordType(payload);\n    var dataID = RelayModernRecord.getDataID(record);\n    process.env.NODE_ENV !== \"production\" ? warning(isClientID(dataID) && dataID !== ROOT_ID || RelayModernRecord.getType(record) === typeName, 'RelayResponseNormalizer: Invalid record `%s`. Expected %s to be ' + 'consistent, but the record was assigned conflicting types `%s` ' + 'and `%s`. The GraphQL server likely violated the globally unique ' + 'id requirement by returning the same id for different objects.', dataID, TYPENAME_KEY, RelayModernRecord.getType(record), typeName) : void 0;\n  }\n  /**\n   * Warns if a single response contains conflicting fields with the same id\n   */\n  ;\n\n  _proto._validateConflictingFieldsWithIdenticalId = function _validateConflictingFieldsWithIdenticalId(record, storageKey, fieldValue) {\n    // NOTE: Only call this function in DEV\n    if (process.env.NODE_ENV !== \"production\") {\n      var dataID = RelayModernRecord.getDataID(record);\n      var previousValue = RelayModernRecord.getValue(record, storageKey);\n      process.env.NODE_ENV !== \"production\" ? warning(storageKey === TYPENAME_KEY || previousValue === undefined || areEqual(previousValue, fieldValue), 'RelayResponseNormalizer: Invalid record. The record contains two ' + 'instances of the same id: `%s` with conflicting field, %s and its values: %s and %s. ' + 'If two fields are different but share ' + 'the same id, one field will overwrite the other.', dataID, storageKey, previousValue, fieldValue) : void 0;\n    }\n  }\n  /**\n   * Warns if a single response contains conflicting fields with the same id\n   */\n  ;\n\n  _proto._validateConflictingLinkedFieldsWithIdenticalId = function _validateConflictingLinkedFieldsWithIdenticalId(record, prevID, nextID, storageKey) {\n    // NOTE: Only call this function in DEV\n    if (process.env.NODE_ENV !== \"production\") {\n      process.env.NODE_ENV !== \"production\" ? warning(prevID === undefined || prevID === nextID, 'RelayResponseNormalizer: Invalid record. The record contains ' + 'references to the conflicting field, %s and its id values: %s and %s. ' + 'We need to make sure that the record the field points ' + 'to remains consistent or one field will overwrite the other.', storageKey, prevID, nextID) : void 0;\n    }\n  };\n\n  return RelayResponseNormalizer;\n}();\n\nmodule.exports = {\n  normalize: normalize\n};"],"mappings":"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"},"metadata":{},"sourceType":"script"}