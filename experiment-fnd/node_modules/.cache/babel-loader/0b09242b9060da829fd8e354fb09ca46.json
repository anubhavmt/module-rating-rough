{"ast":null,"code":"/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * \n * @format\n */\n// flowlint ambiguous-object-type:error\n'use strict';\n\nvar RelayModernRecord = require('../store/RelayModernRecord');\n\nvar _require = require('../store/RelayRecordState'),\n    EXISTENT = _require.EXISTENT,\n    NONEXISTENT = _require.NONEXISTENT;\n\nvar _require2 = require('../store/RelayStoreUtils'),\n    ROOT_ID = _require2.ROOT_ID,\n    ROOT_TYPE = _require2.ROOT_TYPE;\n\nvar _require3 = require('./readUpdatableFragment_EXPERIMENTAL'),\n    _readUpdatableFragment_EXPERIMENTAL = _require3.readUpdatableFragment_EXPERIMENTAL;\n\nvar _require4 = require('./readUpdatableQuery_EXPERIMENTAL'),\n    _readUpdatableQuery_EXPERIMENTAL = _require4.readUpdatableQuery_EXPERIMENTAL;\n\nvar RelayRecordProxy = require('./RelayRecordProxy');\n\nvar invariant = require('invariant');\n/**\n * @internal\n *\n * A helper for manipulating a `RecordSource` via an imperative/OO-style API.\n */\n\n\nvar RelayRecordSourceProxy = /*#__PURE__*/function () {\n  function RelayRecordSourceProxy(mutator, getDataID, handlerProvider) {\n    this.__mutator = mutator;\n    this._handlerProvider = handlerProvider || null;\n    this._proxies = {};\n    this._getDataID = getDataID;\n    this._invalidatedStore = false;\n    this._idsMarkedForInvalidation = new Set();\n  }\n\n  var _proto = RelayRecordSourceProxy.prototype;\n\n  _proto.publishSource = function publishSource(source, fieldPayloads) {\n    var _this = this;\n\n    var dataIDs = source.getRecordIDs();\n    dataIDs.forEach(function (dataID) {\n      var status = source.getStatus(dataID);\n\n      if (status === EXISTENT) {\n        var sourceRecord = source.get(dataID);\n\n        if (sourceRecord) {\n          if (_this.__mutator.getStatus(dataID) !== EXISTENT) {\n            _this.create(dataID, RelayModernRecord.getType(sourceRecord));\n          }\n\n          _this.__mutator.copyFieldsFromRecord(sourceRecord, dataID);\n        }\n      } else if (status === NONEXISTENT) {\n        _this[\"delete\"](dataID);\n      }\n    });\n\n    if (fieldPayloads && fieldPayloads.length) {\n      fieldPayloads.forEach(function (fieldPayload) {\n        var handler = _this._handlerProvider && _this._handlerProvider(fieldPayload.handle);\n\n        !handler ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayModernEnvironment: Expected a handler to be provided for handle `%s`.', fieldPayload.handle) : invariant(false) : void 0;\n        handler.update(_this, fieldPayload);\n      });\n    }\n  };\n\n  _proto.create = function create(dataID, typeName) {\n    this.__mutator.create(dataID, typeName);\n\n    delete this._proxies[dataID];\n    var record = this.get(dataID); // For flow\n\n    !record ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayRecordSourceProxy#create(): Expected the created record to exist.') : invariant(false) : void 0;\n    return record;\n  };\n\n  _proto[\"delete\"] = function _delete(dataID) {\n    !(dataID !== ROOT_ID) ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayRecordSourceProxy#delete(): Cannot delete the root record.') : invariant(false) : void 0;\n    delete this._proxies[dataID];\n\n    this.__mutator[\"delete\"](dataID);\n  };\n\n  _proto.get = function get(dataID) {\n    if (!this._proxies.hasOwnProperty(dataID)) {\n      var status = this.__mutator.getStatus(dataID);\n\n      if (status === EXISTENT) {\n        this._proxies[dataID] = new RelayRecordProxy(this, this.__mutator, dataID);\n      } else {\n        this._proxies[dataID] = status === NONEXISTENT ? null : undefined;\n      }\n    }\n\n    return this._proxies[dataID];\n  };\n\n  _proto.getRoot = function getRoot() {\n    var root = this.get(ROOT_ID);\n\n    if (!root) {\n      root = this.create(ROOT_ID, ROOT_TYPE);\n    }\n\n    !(root && root.getType() === ROOT_TYPE) ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayRecordSourceProxy#getRoot(): Expected the source to contain a ' + 'root record, %s.', root == null ? 'no root record found' : \"found a root record of type `\".concat(root.getType(), \"`\")) : invariant(false) : void 0;\n    return root;\n  };\n\n  _proto.invalidateStore = function invalidateStore() {\n    this._invalidatedStore = true;\n  };\n\n  _proto.isStoreMarkedForInvalidation = function isStoreMarkedForInvalidation() {\n    return this._invalidatedStore;\n  };\n\n  _proto.markIDForInvalidation = function markIDForInvalidation(dataID) {\n    this._idsMarkedForInvalidation.add(dataID);\n  };\n\n  _proto.getIDsMarkedForInvalidation = function getIDsMarkedForInvalidation() {\n    return this._idsMarkedForInvalidation;\n  };\n\n  _proto.readUpdatableQuery_EXPERIMENTAL = function readUpdatableQuery_EXPERIMENTAL(query, variables) {\n    return _readUpdatableQuery_EXPERIMENTAL(query, variables, this);\n  };\n\n  _proto.readUpdatableFragment_EXPERIMENTAL = function readUpdatableFragment_EXPERIMENTAL(fragment, fragmentReference) {\n    return _readUpdatableFragment_EXPERIMENTAL(fragment, fragmentReference, this);\n  };\n\n  return RelayRecordSourceProxy;\n}();\n\nmodule.exports = RelayRecordSourceProxy;","map":{"version":3,"names":["RelayModernRecord","require","_require","EXISTENT","NONEXISTENT","_require2","ROOT_ID","ROOT_TYPE","_require3","_readUpdatableFragment_EXPERIMENTAL","readUpdatableFragment_EXPERIMENTAL","_require4","_readUpdatableQuery_EXPERIMENTAL","readUpdatableQuery_EXPERIMENTAL","RelayRecordProxy","invariant","RelayRecordSourceProxy","mutator","getDataID","handlerProvider","__mutator","_handlerProvider","_proxies","_getDataID","_invalidatedStore","_idsMarkedForInvalidation","Set","_proto","prototype","publishSource","source","fieldPayloads","_this","dataIDs","getRecordIDs","forEach","dataID","status","getStatus","sourceRecord","get","create","getType","copyFieldsFromRecord","length","fieldPayload","handler","handle","process","env","NODE_ENV","update","typeName","record","_delete","hasOwnProperty","undefined","getRoot","root","concat","invalidateStore","isStoreMarkedForInvalidation","markIDForInvalidation","add","getIDsMarkedForInvalidation","query","variables","fragment","fragmentReference","module","exports"],"sources":["/Users/anubhavgupta/Documents/react_learning/experiment_schema_ratings/rating-frontent-with-gql/module-rating-rough/experiment-fnd/node_modules/relay-runtime/lib/mutations/RelayRecordSourceProxy.js"],"sourcesContent":["/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * \n * @format\n */\n// flowlint ambiguous-object-type:error\n'use strict';\n\nvar RelayModernRecord = require('../store/RelayModernRecord');\n\nvar _require = require('../store/RelayRecordState'),\n    EXISTENT = _require.EXISTENT,\n    NONEXISTENT = _require.NONEXISTENT;\n\nvar _require2 = require('../store/RelayStoreUtils'),\n    ROOT_ID = _require2.ROOT_ID,\n    ROOT_TYPE = _require2.ROOT_TYPE;\n\nvar _require3 = require('./readUpdatableFragment_EXPERIMENTAL'),\n    _readUpdatableFragment_EXPERIMENTAL = _require3.readUpdatableFragment_EXPERIMENTAL;\n\nvar _require4 = require('./readUpdatableQuery_EXPERIMENTAL'),\n    _readUpdatableQuery_EXPERIMENTAL = _require4.readUpdatableQuery_EXPERIMENTAL;\n\nvar RelayRecordProxy = require('./RelayRecordProxy');\n\nvar invariant = require('invariant');\n/**\n * @internal\n *\n * A helper for manipulating a `RecordSource` via an imperative/OO-style API.\n */\n\n\nvar RelayRecordSourceProxy = /*#__PURE__*/function () {\n  function RelayRecordSourceProxy(mutator, getDataID, handlerProvider) {\n    this.__mutator = mutator;\n    this._handlerProvider = handlerProvider || null;\n    this._proxies = {};\n    this._getDataID = getDataID;\n    this._invalidatedStore = false;\n    this._idsMarkedForInvalidation = new Set();\n  }\n\n  var _proto = RelayRecordSourceProxy.prototype;\n\n  _proto.publishSource = function publishSource(source, fieldPayloads) {\n    var _this = this;\n\n    var dataIDs = source.getRecordIDs();\n    dataIDs.forEach(function (dataID) {\n      var status = source.getStatus(dataID);\n\n      if (status === EXISTENT) {\n        var sourceRecord = source.get(dataID);\n\n        if (sourceRecord) {\n          if (_this.__mutator.getStatus(dataID) !== EXISTENT) {\n            _this.create(dataID, RelayModernRecord.getType(sourceRecord));\n          }\n\n          _this.__mutator.copyFieldsFromRecord(sourceRecord, dataID);\n        }\n      } else if (status === NONEXISTENT) {\n        _this[\"delete\"](dataID);\n      }\n    });\n\n    if (fieldPayloads && fieldPayloads.length) {\n      fieldPayloads.forEach(function (fieldPayload) {\n        var handler = _this._handlerProvider && _this._handlerProvider(fieldPayload.handle);\n\n        !handler ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayModernEnvironment: Expected a handler to be provided for handle `%s`.', fieldPayload.handle) : invariant(false) : void 0;\n        handler.update(_this, fieldPayload);\n      });\n    }\n  };\n\n  _proto.create = function create(dataID, typeName) {\n    this.__mutator.create(dataID, typeName);\n\n    delete this._proxies[dataID];\n    var record = this.get(dataID); // For flow\n\n    !record ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayRecordSourceProxy#create(): Expected the created record to exist.') : invariant(false) : void 0;\n    return record;\n  };\n\n  _proto[\"delete\"] = function _delete(dataID) {\n    !(dataID !== ROOT_ID) ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayRecordSourceProxy#delete(): Cannot delete the root record.') : invariant(false) : void 0;\n    delete this._proxies[dataID];\n\n    this.__mutator[\"delete\"](dataID);\n  };\n\n  _proto.get = function get(dataID) {\n    if (!this._proxies.hasOwnProperty(dataID)) {\n      var status = this.__mutator.getStatus(dataID);\n\n      if (status === EXISTENT) {\n        this._proxies[dataID] = new RelayRecordProxy(this, this.__mutator, dataID);\n      } else {\n        this._proxies[dataID] = status === NONEXISTENT ? null : undefined;\n      }\n    }\n\n    return this._proxies[dataID];\n  };\n\n  _proto.getRoot = function getRoot() {\n    var root = this.get(ROOT_ID);\n\n    if (!root) {\n      root = this.create(ROOT_ID, ROOT_TYPE);\n    }\n\n    !(root && root.getType() === ROOT_TYPE) ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'RelayRecordSourceProxy#getRoot(): Expected the source to contain a ' + 'root record, %s.', root == null ? 'no root record found' : \"found a root record of type `\".concat(root.getType(), \"`\")) : invariant(false) : void 0;\n    return root;\n  };\n\n  _proto.invalidateStore = function invalidateStore() {\n    this._invalidatedStore = true;\n  };\n\n  _proto.isStoreMarkedForInvalidation = function isStoreMarkedForInvalidation() {\n    return this._invalidatedStore;\n  };\n\n  _proto.markIDForInvalidation = function markIDForInvalidation(dataID) {\n    this._idsMarkedForInvalidation.add(dataID);\n  };\n\n  _proto.getIDsMarkedForInvalidation = function getIDsMarkedForInvalidation() {\n    return this._idsMarkedForInvalidation;\n  };\n\n  _proto.readUpdatableQuery_EXPERIMENTAL = function readUpdatableQuery_EXPERIMENTAL(query, variables) {\n    return _readUpdatableQuery_EXPERIMENTAL(query, variables, this);\n  };\n\n  _proto.readUpdatableFragment_EXPERIMENTAL = function readUpdatableFragment_EXPERIMENTAL(fragment, fragmentReference) {\n    return _readUpdatableFragment_EXPERIMENTAL(fragment, fragmentReference, this);\n  };\n\n  return RelayRecordSourceProxy;\n}();\n\nmodule.exports = RelayRecordSourceProxy;"],"mappings":"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"},"metadata":{},"sourceType":"script"}