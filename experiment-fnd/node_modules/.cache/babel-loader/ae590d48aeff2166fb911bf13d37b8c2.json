{"ast":null,"code":"/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * \n * @format\n */\n// flowlint ambiguous-object-type:error\n'use strict';\n\nvar ReactRelayContext = require('./ReactRelayContext');\n\nvar ReactRelayQueryRendererContext = require('./ReactRelayQueryRendererContext');\n\nvar areEqual = require(\"fbjs/lib/areEqual\");\n\nvar React = require('react');\n\nvar _require = require('relay-runtime'),\n    createOperationDescriptor = _require.createOperationDescriptor,\n    deepFreeze = _require.deepFreeze,\n    getRequest = _require.getRequest;\n\nvar useLayoutEffect = React.useLayoutEffect,\n    useState = React.useState,\n    useRef = React.useRef,\n    useMemo = React.useMemo;\nvar queryRendererContext = {\n  rootIsQueryRenderer: true\n};\n\nfunction useDeepCompare(value) {\n  var latestValue = React.useRef(value);\n\n  if (!areEqual(latestValue.current, value)) {\n    if (process.env.NODE_ENV !== \"production\") {\n      deepFreeze(value);\n    }\n\n    latestValue.current = value;\n  }\n\n  return latestValue.current;\n}\n\nfunction ReactRelayLocalQueryRenderer(props) {\n  var environment = props.environment,\n      query = props.query,\n      variables = props.variables,\n      render = props.render;\n  var latestVariables = useDeepCompare(variables);\n  var operation = useMemo(function () {\n    var request = getRequest(query);\n    return createOperationDescriptor(request, latestVariables);\n  }, [query, latestVariables]);\n  var relayContext = useMemo(function () {\n    return {\n      environment: environment\n    };\n  }, [environment]); // Use a ref to prevent rendering twice when data changes\n  // because of props change\n\n  var dataRef = useRef(null);\n\n  var _useState = useState(null),\n      forceUpdate = _useState[1];\n\n  var cleanupFnRef = useRef(null);\n  var snapshot = useMemo(function () {\n    environment.check(operation);\n    var res = environment.lookup(operation.fragment);\n    dataRef.current = res.data; // Run effects here so that the data can be retained\n    // and subscribed before the component commits\n\n    var retainDisposable = environment.retain(operation);\n    var subscribeDisposable = environment.subscribe(res, function (newSnapshot) {\n      dataRef.current = newSnapshot.data;\n      forceUpdate(dataRef.current);\n    });\n    var disposed = false;\n\n    function nextCleanupFn() {\n      if (!disposed) {\n        disposed = true;\n        cleanupFnRef.current = null;\n        retainDisposable.dispose();\n        subscribeDisposable.dispose();\n      }\n    }\n\n    if (cleanupFnRef.current) {\n      cleanupFnRef.current();\n    }\n\n    cleanupFnRef.current = nextCleanupFn;\n    return res;\n  }, [environment, operation]);\n  useLayoutEffect(function () {\n    var cleanupFn = cleanupFnRef.current;\n    return function () {\n      cleanupFn && cleanupFn();\n    };\n  }, [snapshot]);\n  return /*#__PURE__*/React.createElement(ReactRelayContext.Provider, {\n    value: relayContext\n  }, /*#__PURE__*/React.createElement(ReactRelayQueryRendererContext.Provider, {\n    value: queryRendererContext\n  }, render({\n    props: dataRef.current\n  })));\n}\n\nmodule.exports = ReactRelayLocalQueryRenderer;","map":{"version":3,"names":["ReactRelayContext","require","ReactRelayQueryRendererContext","areEqual","React","_require","createOperationDescriptor","deepFreeze","getRequest","useLayoutEffect","useState","useRef","useMemo","queryRendererContext","rootIsQueryRenderer","useDeepCompare","value","latestValue","current","process","env","NODE_ENV","ReactRelayLocalQueryRenderer","props","environment","query","variables","render","latestVariables","operation","request","relayContext","dataRef","_useState","forceUpdate","cleanupFnRef","snapshot","check","res","lookup","fragment","data","retainDisposable","retain","subscribeDisposable","subscribe","newSnapshot","disposed","nextCleanupFn","dispose","cleanupFn","createElement","Provider","module","exports"],"sources":["/Users/anubhavgupta/Documents/react_learning/experiment_schema_ratings/rating-frontent-with-gql/module-rating-rough/experiment-fnd/node_modules/react-relay/lib/ReactRelayLocalQueryRenderer.js"],"sourcesContent":["/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * \n * @format\n */\n// flowlint ambiguous-object-type:error\n'use strict';\n\nvar ReactRelayContext = require('./ReactRelayContext');\n\nvar ReactRelayQueryRendererContext = require('./ReactRelayQueryRendererContext');\n\nvar areEqual = require(\"fbjs/lib/areEqual\");\n\nvar React = require('react');\n\nvar _require = require('relay-runtime'),\n    createOperationDescriptor = _require.createOperationDescriptor,\n    deepFreeze = _require.deepFreeze,\n    getRequest = _require.getRequest;\n\nvar useLayoutEffect = React.useLayoutEffect,\n    useState = React.useState,\n    useRef = React.useRef,\n    useMemo = React.useMemo;\nvar queryRendererContext = {\n  rootIsQueryRenderer: true\n};\n\nfunction useDeepCompare(value) {\n  var latestValue = React.useRef(value);\n\n  if (!areEqual(latestValue.current, value)) {\n    if (process.env.NODE_ENV !== \"production\") {\n      deepFreeze(value);\n    }\n\n    latestValue.current = value;\n  }\n\n  return latestValue.current;\n}\n\nfunction ReactRelayLocalQueryRenderer(props) {\n  var environment = props.environment,\n      query = props.query,\n      variables = props.variables,\n      render = props.render;\n  var latestVariables = useDeepCompare(variables);\n  var operation = useMemo(function () {\n    var request = getRequest(query);\n    return createOperationDescriptor(request, latestVariables);\n  }, [query, latestVariables]);\n  var relayContext = useMemo(function () {\n    return {\n      environment: environment\n    };\n  }, [environment]); // Use a ref to prevent rendering twice when data changes\n  // because of props change\n\n  var dataRef = useRef(null);\n\n  var _useState = useState(null),\n      forceUpdate = _useState[1];\n\n  var cleanupFnRef = useRef(null);\n  var snapshot = useMemo(function () {\n    environment.check(operation);\n    var res = environment.lookup(operation.fragment);\n    dataRef.current = res.data; // Run effects here so that the data can be retained\n    // and subscribed before the component commits\n\n    var retainDisposable = environment.retain(operation);\n    var subscribeDisposable = environment.subscribe(res, function (newSnapshot) {\n      dataRef.current = newSnapshot.data;\n      forceUpdate(dataRef.current);\n    });\n    var disposed = false;\n\n    function nextCleanupFn() {\n      if (!disposed) {\n        disposed = true;\n        cleanupFnRef.current = null;\n        retainDisposable.dispose();\n        subscribeDisposable.dispose();\n      }\n    }\n\n    if (cleanupFnRef.current) {\n      cleanupFnRef.current();\n    }\n\n    cleanupFnRef.current = nextCleanupFn;\n    return res;\n  }, [environment, operation]);\n  useLayoutEffect(function () {\n    var cleanupFn = cleanupFnRef.current;\n    return function () {\n      cleanupFn && cleanupFn();\n    };\n  }, [snapshot]);\n  return /*#__PURE__*/React.createElement(ReactRelayContext.Provider, {\n    value: relayContext\n  }, /*#__PURE__*/React.createElement(ReactRelayQueryRendererContext.Provider, {\n    value: queryRendererContext\n  }, render({\n    props: dataRef.current\n  })));\n}\n\nmodule.exports = ReactRelayLocalQueryRenderer;"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAIA,iBAAiB,GAAGC,OAAO,CAAC,qBAAD,CAA/B;;AAEA,IAAIC,8BAA8B,GAAGD,OAAO,CAAC,kCAAD,CAA5C;;AAEA,IAAIE,QAAQ,GAAGF,OAAO,CAAC,mBAAD,CAAtB;;AAEA,IAAIG,KAAK,GAAGH,OAAO,CAAC,OAAD,CAAnB;;AAEA,IAAII,QAAQ,GAAGJ,OAAO,CAAC,eAAD,CAAtB;AAAA,IACIK,yBAAyB,GAAGD,QAAQ,CAACC,yBADzC;AAAA,IAEIC,UAAU,GAAGF,QAAQ,CAACE,UAF1B;AAAA,IAGIC,UAAU,GAAGH,QAAQ,CAACG,UAH1B;;AAKA,IAAIC,eAAe,GAAGL,KAAK,CAACK,eAA5B;AAAA,IACIC,QAAQ,GAAGN,KAAK,CAACM,QADrB;AAAA,IAEIC,MAAM,GAAGP,KAAK,CAACO,MAFnB;AAAA,IAGIC,OAAO,GAAGR,KAAK,CAACQ,OAHpB;AAIA,IAAIC,oBAAoB,GAAG;EACzBC,mBAAmB,EAAE;AADI,CAA3B;;AAIA,SAASC,cAAT,CAAwBC,KAAxB,EAA+B;EAC7B,IAAIC,WAAW,GAAGb,KAAK,CAACO,MAAN,CAAaK,KAAb,CAAlB;;EAEA,IAAI,CAACb,QAAQ,CAACc,WAAW,CAACC,OAAb,EAAsBF,KAAtB,CAAb,EAA2C;IACzC,IAAIG,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,YAA7B,EAA2C;MACzCd,UAAU,CAACS,KAAD,CAAV;IACD;;IAEDC,WAAW,CAACC,OAAZ,GAAsBF,KAAtB;EACD;;EAED,OAAOC,WAAW,CAACC,OAAnB;AACD;;AAED,SAASI,4BAAT,CAAsCC,KAAtC,EAA6C;EAC3C,IAAIC,WAAW,GAAGD,KAAK,CAACC,WAAxB;EAAA,IACIC,KAAK,GAAGF,KAAK,CAACE,KADlB;EAAA,IAEIC,SAAS,GAAGH,KAAK,CAACG,SAFtB;EAAA,IAGIC,MAAM,GAAGJ,KAAK,CAACI,MAHnB;EAIA,IAAIC,eAAe,GAAGb,cAAc,CAACW,SAAD,CAApC;EACA,IAAIG,SAAS,GAAGjB,OAAO,CAAC,YAAY;IAClC,IAAIkB,OAAO,GAAGtB,UAAU,CAACiB,KAAD,CAAxB;IACA,OAAOnB,yBAAyB,CAACwB,OAAD,EAAUF,eAAV,CAAhC;EACD,CAHsB,EAGpB,CAACH,KAAD,EAAQG,eAAR,CAHoB,CAAvB;EAIA,IAAIG,YAAY,GAAGnB,OAAO,CAAC,YAAY;IACrC,OAAO;MACLY,WAAW,EAAEA;IADR,CAAP;EAGD,CAJyB,EAIvB,CAACA,WAAD,CAJuB,CAA1B,CAV2C,CAcxB;EACnB;;EAEA,IAAIQ,OAAO,GAAGrB,MAAM,CAAC,IAAD,CAApB;;EAEA,IAAIsB,SAAS,GAAGvB,QAAQ,CAAC,IAAD,CAAxB;EAAA,IACIwB,WAAW,GAAGD,SAAS,CAAC,CAAD,CAD3B;;EAGA,IAAIE,YAAY,GAAGxB,MAAM,CAAC,IAAD,CAAzB;EACA,IAAIyB,QAAQ,GAAGxB,OAAO,CAAC,YAAY;IACjCY,WAAW,CAACa,KAAZ,CAAkBR,SAAlB;IACA,IAAIS,GAAG,GAAGd,WAAW,CAACe,MAAZ,CAAmBV,SAAS,CAACW,QAA7B,CAAV;IACAR,OAAO,CAACd,OAAR,GAAkBoB,GAAG,CAACG,IAAtB,CAHiC,CAGL;IAC5B;;IAEA,IAAIC,gBAAgB,GAAGlB,WAAW,CAACmB,MAAZ,CAAmBd,SAAnB,CAAvB;IACA,IAAIe,mBAAmB,GAAGpB,WAAW,CAACqB,SAAZ,CAAsBP,GAAtB,EAA2B,UAAUQ,WAAV,EAAuB;MAC1Ed,OAAO,CAACd,OAAR,GAAkB4B,WAAW,CAACL,IAA9B;MACAP,WAAW,CAACF,OAAO,CAACd,OAAT,CAAX;IACD,CAHyB,CAA1B;IAIA,IAAI6B,QAAQ,GAAG,KAAf;;IAEA,SAASC,aAAT,GAAyB;MACvB,IAAI,CAACD,QAAL,EAAe;QACbA,QAAQ,GAAG,IAAX;QACAZ,YAAY,CAACjB,OAAb,GAAuB,IAAvB;QACAwB,gBAAgB,CAACO,OAAjB;QACAL,mBAAmB,CAACK,OAApB;MACD;IACF;;IAED,IAAId,YAAY,CAACjB,OAAjB,EAA0B;MACxBiB,YAAY,CAACjB,OAAb;IACD;;IAEDiB,YAAY,CAACjB,OAAb,GAAuB8B,aAAvB;IACA,OAAOV,GAAP;EACD,CA5BqB,EA4BnB,CAACd,WAAD,EAAcK,SAAd,CA5BmB,CAAtB;EA6BApB,eAAe,CAAC,YAAY;IAC1B,IAAIyC,SAAS,GAAGf,YAAY,CAACjB,OAA7B;IACA,OAAO,YAAY;MACjBgC,SAAS,IAAIA,SAAS,EAAtB;IACD,CAFD;EAGD,CALc,EAKZ,CAACd,QAAD,CALY,CAAf;EAMA,OAAO,aAAahC,KAAK,CAAC+C,aAAN,CAAoBnD,iBAAiB,CAACoD,QAAtC,EAAgD;IAClEpC,KAAK,EAAEe;EAD2D,CAAhD,EAEjB,aAAa3B,KAAK,CAAC+C,aAAN,CAAoBjD,8BAA8B,CAACkD,QAAnD,EAA6D;IAC3EpC,KAAK,EAAEH;EADoE,CAA7D,EAEbc,MAAM,CAAC;IACRJ,KAAK,EAAES,OAAO,CAACd;EADP,CAAD,CAFO,CAFI,CAApB;AAOD;;AAEDmC,MAAM,CAACC,OAAP,GAAiBhC,4BAAjB"},"metadata":{},"sourceType":"script"}